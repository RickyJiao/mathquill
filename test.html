<html>
  <head>
    <link rel="stylesheet" href="build/mathquill.css"/>
    <meta charset="utf-8"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="build/mathquill.js"></script>
    <title>MathQuill with Macros</title>
  </head>
  <body>
    <h1>MathQuill with Macros</h1>


    Type \abs for absolute value. Type \intinf for an infinite
    integral template. Or add your own macros below.
    
    <p><span id="math">x+</span></p>

    <script>
      var MQ = MathQuill.getInterface(2);

      // Note: these have global effect (for all existing and future MathFields)
      MQ.addMacro("abs","\\left|\\cursor\\right|");
      MQ.addMacro("intinf","\\int_{-\\infty}^{\\infty}\\ \\cursor\\ dx");

      var math = MQ.MathField($("#math")[0]);
      math.focus();

      function escape(str) { return str.replace(/&/g, '&amp;').replace(/>/g, '&gt;').replace(/</g, '&lt;'); }

      function addmacro() {
        var name = $("#macroname")[0].value;
        var code = $("#code")[0].value;
        MQ.addMacro(name,code);
        math.focus();
        $("#log").append("Adding macro <tt>\\"+name+"</tt> with code <tt>"+escape(code)+"</tt>.<br/>");
//        $("<div>").appendTo("#log").text("Adding macro \"+name+" with code <tt>"+escape(code)+"</tt>.<br/>");
      }
    </script>

    <table style="border: solid 1px">
      <tr><td>Macro name:</td><td><input id=macroname value="example"/></td><td>Without leading <tt>\</tt>.</td></tr>
      <tr><td>Latex code:</td><td><textarea id=code cols=50>\left[\left[\left[\cursor^2\right]\right]\right]</textarea></td><td>Use <tt>\cursor</tt> to mark the cursor position (optional).</td></tr>
      <tr><td><button onclick="addmacro()" accesskey=m>Add macro</button></td></tr>
    </table>

    <span id=log style="font-size: smaller"></span>
  </body>
</html>
